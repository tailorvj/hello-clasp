<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://ssl.gstatic.com/docs/script/css/add-ons1.css">
    <title>My Sidebar</title>
</head>

<body>
    <div>
        <input type="button" id="helloWorldButton" class="action" value="Say Hello World">
    </div>
    
    <!-- New button to trigger the error function -->
    <div>
        <input type="button" id="errorButton" class="action" value="Trigger Error">
    </div>

    <div>
        <input type="text" id="folderId" placeholder="Enter folder ID">
        <input type="button" id="imageButton" class="action" value="Submit">
       
      </div>

    <!-- Div to display the error message -->
    <div id="errorDiv" style="color: red; display: none;"></div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            var helloWorldButton = document.getElementById("helloWorldButton");
            var errorButton = document.getElementById("errorButton");
            var errorDiv = document.getElementById("errorDiv");

            helloWorldButton.addEventListener("click", function () {
                try {
                    google.script.run.helloWorld();
                } catch (e) {
                    window.alert("Error: " + e.details);
                }
            });

            // Event listener for the errorButton
            errorButton.addEventListener("click", function () {
                google.script.run
                    .withSuccessHandler(function () {
                        // Optional: Handle success here if needed
                    })
                    .withFailureHandler(function (error) {
                        // Display the error message in the errorDiv
                        errorDiv.textContent = error.message;
                        errorDiv.style.display = 'block';
                    })
                    .throwError();
            });

            imageButton.addEventListener("click", function () {
                var folderId = document.getElementById('folderId').value;

                google.script.run
                    .withSuccessHandler(function () {
                        errorDiv.textContent = 'got images';
                        errorDiv.style.display = 'block';
                    })
                    .withFailureHandler(function (error) {
                        // Display the error message in the errorDiv
                        errorDiv.textContent = error.message;
                        errorDiv.style.display = 'block';
                    })
                    .createSlidesFromImages(folderId);
            });
        });
    </script>
</body>

</html>
